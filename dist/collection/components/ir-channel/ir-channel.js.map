{"version":3,"file":"ir-channel.js","sourceRoot":"","sources":["../../../src/components/ir-channel/ir-channel.tsx"],"names":[],"mappings":"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","sourcesContent":["import { RoomService } from '@/services/room.service';\r\nimport channels_data, { resetStore } from '@/stores/channel.store';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Host, Prop, Watch, h, Element, State, Fragment } from '@stencil/core';\r\nimport axios from 'axios';\r\nimport { actions } from './data';\r\n\r\n@Component({\r\n  tag: 'ir-channel',\r\n  styleUrl: 'ir-channel.css',\r\n  scoped: true,\r\n})\r\nexport class IrChannel {\r\n  @Element() el: HTMLElement;\r\n\r\n  @Prop() ticket: string = '';\r\n  @Prop() propertyid: number;\r\n  @Prop() language: string;\r\n  @Prop() baseurl: string;\r\n\r\n  @State() channel_status: 'create' | 'edit' | null = null;\r\n\r\n  private roomService = new RoomService();\r\n\r\n  componentWillLoad() {\r\n    if (this.baseurl) {\r\n      axios.defaults.baseURL = this.baseurl;\r\n    }\r\n    if (this.ticket !== '') {\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  async initializeApp() {\r\n    try {\r\n      const [, , , languageTexts] = await Promise.all([\r\n        this.roomService.fetchData(this.propertyid, this.language),\r\n        this.roomService.getExposedChannels(),\r\n        this.roomService.getExposedConnectedChannels(this.propertyid),\r\n        this.roomService.fetchLanguage(this.language),\r\n      ]);\r\n      channels_data.property_id = this.propertyid;\r\n      if (!locales.entries) {\r\n        locales.entries = languageTexts.entries;\r\n        locales.direction = languageTexts.direction;\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  @Watch('ticket')\r\n  async ticketChanged() {\r\n    sessionStorage.setItem('token', JSON.stringify(this.ticket));\r\n    this.initializeApp();\r\n  }\r\n  render() {\r\n    return (\r\n      <Host class=\"bg-white h-100\">\r\n        <section class=\"p-2\">\r\n          <div class=\"d-flex w-100 justify-content-end mb-2\">\r\n            <ir-button text={'Create'} size=\"sm\" onClickHanlder={() => (this.channel_status = 'create')}></ir-button>\r\n          </div>\r\n          <div class=\"table-container\">\r\n            <table class=\"table table-hover\">\r\n              <thead>\r\n                <tr>\r\n                  <th scope=\"col\" class=\"text-left\">\r\n                    Title\r\n                  </th>\r\n                  <th scope=\"col\">Channel</th>\r\n                  <th scope=\"col\">Status</th>\r\n                  <th scope=\"col\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody class=\"\">\r\n                {channels_data.connected_channels?.map(channel => (\r\n                  <tr key={channel.channel.id}>\r\n                    <th scope=\"row\" class=\"text-left\">\r\n                      {channel.title}\r\n                    </th>\r\n                    <th scope=\"row\">{channel.channel.name}</th>\r\n                    <td>\r\n                      <ir-switch checked={channel.is_active}></ir-switch>\r\n                    </td>\r\n                    <th>\r\n                      <div class=\"btn-group\">\r\n                        <button type=\"button\" class=\"btn  dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n                          <span class=\"mr-1\">Actions</span>\r\n                          <svg class={'caret-icon'} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" height={14} width={14}>\r\n                            <path\r\n                              fill=\"var(--blue)\"\r\n                              d=\"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z\"\r\n                            />\r\n                          </svg>\r\n                        </button>\r\n                        <div class=\"dropdown-menu dropdown-menu-right\">\r\n                          {actions(locales.entries).map((a, index) => (\r\n                            <Fragment>\r\n                              {index === actions(locales.entries).length - 1 && <div key={a.id + '_divider'} class=\"dropdown-divider my-0\"></div>}\r\n                              <button\r\n                                onClick={() => {\r\n                                  console.log(a.id);\r\n                                  a.action(channel);\r\n                                  if (a.id === 'edit') {\r\n                                    setTimeout(() => {\r\n                                      this.channel_status = 'edit';\r\n                                    }, 300);\r\n                                  }\r\n                                }}\r\n                                key={a.id + '_item'}\r\n                                class={`dropdown-item my-0 ${a.id === 'remove' ? 'danger' : ''}`}\r\n                                type=\"button\"\r\n                              >\r\n                                {a.icon()}\r\n                                {a.name}\r\n                              </button>\r\n                            </Fragment>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n        <ir-sidebar\r\n          sidebarStyles={{\r\n            width: '60rem',\r\n          }}\r\n          showCloseButton={false}\r\n          onIrSidebarToggle={e => {\r\n            e.stopImmediatePropagation();\r\n            e.stopPropagation();\r\n            this.channel_status = null;\r\n            resetStore();\r\n          }}\r\n          open={this.channel_status !== null}\r\n        >\r\n          {this.channel_status && (\r\n            <ir-channel-editor\r\n              class=\"p-1\"\r\n              channel_status={this.channel_status}\r\n              onCloseSideBar={() => {\r\n                this.channel_status = null;\r\n                resetStore();\r\n              }}\r\n            ></ir-channel-editor>\r\n          )}\r\n        </ir-sidebar>\r\n        <ir-modal></ir-modal>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}
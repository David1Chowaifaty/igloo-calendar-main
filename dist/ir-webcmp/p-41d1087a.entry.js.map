{"version":3,"names":["iglBlockDatesViewCss","IglBlockDatesView","this","blockDatesData","RELEASE_AFTER_HOURS","OPTIONAL_REASON","OUT_OF_SERVICE","releaseList","bookingService","BookingService","componentWillLoad","setToken","calendar_data","token","getBlockedInfo","defaultData","Object","assign","parseInt","CODE_NAME","emitData","error","handleOptionalReason","event","target","value","handleReleaseAfterChange","evt","entryDate","undefined","renderPage","dataUpdateEvent","emit","key","data","getReleaseHoursString","dt","Date","entryHour","entryMinute","setHours","getHours","getMinutes","toLocaleString","month","getDate","formatNumber","handleOutOfService","checked","renderAgain","render","h","Host","class","locales","entries","Lcz_From","formatDate","fromDate","Lcz_To","toDate","isEventHover","Lcz_Reason","type","id","onChange","Lcz_OutOfservice","Lcz_Or","placeholder","Lcz_OptionalReason","onInput","Lcz_AutomaticReleaseIn","map","releaseItem","selected","CODE_VALUE_EN","Lcz_On"],"sources":["src/components/igloo-calendar/igl-block-dates-view/igl-block-dates-view.css?tag=igl-block-dates-view&encapsulation=scoped","src/components/igloo-calendar/igl-block-dates-view/igl-block-dates-view.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n\r\n:host .controlContainer {\r\n  width: 24px;\r\n}\r\n\r\n:host .checkBoxContainer input {\r\n  height: 1.2rem !important;\r\n  width: 30px;\r\n}\r\n\r\n.releaseTime {\r\n  padding-left: 5px;\r\n}\r\n.out-of-service-label {\r\n  margin-left: 5px !important;\r\n}\r\n","import { Component, Host, h, Prop, State, Event, EventEmitter } from '@stencil/core';\r\nimport { BookingService } from '../../../services/booking.service';\r\nimport { IEntries } from '../../../models/IBooking';\r\nimport { formatDate } from '../../../utils/utils';\r\nimport locales from '@/stores/locales.store';\r\nimport calendar_data from '@/stores/calendar-data';\r\n\r\n@Component({\r\n  tag: 'igl-block-dates-view',\r\n  styleUrl: 'igl-block-dates-view.css',\r\n  scoped: true,\r\n})\r\nexport class IglBlockDatesView {\r\n  @Prop() defaultData: { [key: string]: any };\r\n  @Prop() fromDate: string;\r\n  @Prop() toDate: string;\r\n  @Prop({ mutable: true }) entryDate: string;\r\n  @Prop() entryHour: number;\r\n  @Prop() isEventHover: boolean = false;\r\n  @Prop() entryMinute: number;\r\n  @State() renderAgain: boolean = false;\r\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\r\n\r\n  private blockDatesData: { [key: string]: any } = {\r\n    RELEASE_AFTER_HOURS: 0,\r\n    OPTIONAL_REASON: '',\r\n    OUT_OF_SERVICE: false,\r\n  }; // Change of property name might require updates in booking-event-hover\r\n  private releaseList: IEntries[] = [];\r\n  private bookingService: BookingService = new BookingService();\r\n\r\n  async componentWillLoad() {\r\n    try {\r\n      this.bookingService.setToken(calendar_data.token);\r\n      this.releaseList = await this.bookingService.getBlockedInfo();\r\n      if (this.defaultData) {\r\n        this.blockDatesData = { ...this.defaultData };\r\n      } else {\r\n        this.blockDatesData.RELEASE_AFTER_HOURS = parseInt(this.releaseList[0].CODE_NAME);\r\n        this.emitData();\r\n      }\r\n    } catch (error) {\r\n      // toastr.error(error);\r\n    }\r\n  }\r\n\r\n  handleOptionalReason(event) {\r\n    this.blockDatesData.OPTIONAL_REASON = event.target.value;\r\n    this.emitData();\r\n  }\r\n\r\n  handleReleaseAfterChange(evt) {\r\n    if (this.entryDate) this.entryDate = undefined;\r\n    this.blockDatesData.RELEASE_AFTER_HOURS = parseInt(evt.target.value);\r\n    this.renderPage();\r\n    this.emitData();\r\n  }\r\n\r\n  emitData() {\r\n    this.dataUpdateEvent.emit({\r\n      key: 'blockDatesData',\r\n      data: { ...this.blockDatesData },\r\n    });\r\n  }\r\n\r\n  getReleaseHoursString() {\r\n    // console.log(\"entry date\", this.entryDate);\r\n    // console.log(\"blocked date data\", this.blockDatesData);\r\n    let dt = this.entryDate ? new Date(this.entryDate) : new Date();\r\n    if (this.entryDate && this.entryHour && this.entryMinute) {\r\n      dt.setHours(this.entryHour, this.entryMinute, 0, 0);\r\n    } else {\r\n      dt.setHours(dt.getHours() + this.blockDatesData.RELEASE_AFTER_HOURS, dt.getMinutes(), 0, 0);\r\n    }\r\n\r\n    return dt.toLocaleString('default', { month: 'short' }) + ' ' + dt.getDate() + ', ' + this.formatNumber(dt.getHours()) + ':' + this.formatNumber(dt.getMinutes());\r\n  }\r\n  formatNumber(value: number) {\r\n    return value < 10 ? `0${value}` : value;\r\n  }\r\n  handleOutOfService(evt) {\r\n    this.blockDatesData.OUT_OF_SERVICE = evt.target.checked;\r\n    if (this.blockDatesData.OUT_OF_SERVICE) {\r\n      this.blockDatesData.OPTIONAL_REASON = '';\r\n      this.blockDatesData.RELEASE_AFTER_HOURS = 0;\r\n    }\r\n    this.renderPage();\r\n    this.emitData();\r\n  }\r\n\r\n  renderPage() {\r\n    this.renderAgain = !this.renderAgain;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class={`m-0 p-0 mb-1`}>\r\n          <div class=\"text-left p-0\">\r\n            <span class=\"pr-1\">\r\n              <span class=\"text-bold-700 font-medium-1\">{locales.entries.Lcz_From}: </span>\r\n              {formatDate(this.fromDate)}\r\n            </span>\r\n            <span class=\"text-bold-700 font-medium-1\">{locales.entries.Lcz_To}: </span>\r\n            {formatDate(this.toDate)}\r\n          </div>\r\n        </div>\r\n        <div class={` mb-1 text-left ${this.isEventHover && 'p-0'}`}>\r\n          <div class=\"mb-1 \">\r\n            <label class=\"p-0 text-bold-700 font-medium-1 m-0 align-middle\">{locales.entries.Lcz_Reason}:</label>\r\n            <div class=\"p-0 m-0 pr-1  controlContainer checkBoxContainer d-inline-block align-middle\">\r\n              <input class=\"form-control\" type=\"checkbox\" checked={this.blockDatesData.OUT_OF_SERVICE} id=\"userinput6\" onChange={event => this.handleOutOfService(event)} />\r\n            </div>\r\n            <span class=\"align-middle out-of-service-label\">{locales.entries.Lcz_OutOfservice}</span>\r\n          </div>\r\n          {!this.blockDatesData.OUT_OF_SERVICE ? (\r\n            <div>\r\n              <div class=\"mb-1 d-flex  align-items-center\">\r\n                <span class=\"align-middle\">{locales.entries.Lcz_Or} </span>\r\n                <div class=\"d-inline-flex col pr-0 align-middle\">\r\n                  <input\r\n                    class=\"form-control\"\r\n                    type=\"text\"\r\n                    placeholder={locales.entries.Lcz_OptionalReason}\r\n                    id=\"optReason\"\r\n                    value={this.blockDatesData.OPTIONAL_REASON}\r\n                    onInput={event => this.handleOptionalReason(event)}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div class=\"mb-1 w-100 pr-0 \">\r\n                <span class=\"text-bold-700 font-medium-1\">{locales.entries.Lcz_AutomaticReleaseIn}: </span>\r\n                <div class=\"d-inline-block\">\r\n                  <select class=\"form-control input-sm\" id=\"zSmallSelect\" onChange={evt => this.handleReleaseAfterChange(evt)}>\r\n                    {this.releaseList.map(releaseItem => (\r\n                      <option value={+releaseItem.CODE_NAME} selected={this.blockDatesData.RELEASE_AFTER_HOURS == +releaseItem.CODE_NAME}>\r\n                        {releaseItem.CODE_VALUE_EN}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                {this.blockDatesData.RELEASE_AFTER_HOURS ? (\r\n                  <div class=\"d-inline-block releaseTime\">\r\n                    <em>\r\n                      {locales.entries.Lcz_On} {this.getReleaseHoursString()}\r\n                    </em>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}